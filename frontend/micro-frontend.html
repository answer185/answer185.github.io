<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>微前端 | 七夜</title>
    <meta name="description" content="记录个人对技术的理解">
    <link rel="stylesheet" href="/assets/style.c3210e46.css">
    <link rel="modulepreload" href="/assets/app.05e3c997.js">
    <link rel="modulepreload" href="/assets/frontend_micro-frontend.md.3097cd22.lean.js">
    
    <meta name="twitter:title" content="微前端 | 七夜">
  <meta property="og:title" content="微前端 | 七夜">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="七夜, back to home" data-v-675d8756 data-v-cc01ef16><!----> 七夜</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/basic/data-structure" data-v-b8818f8c>编程基础 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/frontend/basic" data-v-b8818f8c>前端 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/backend/nodejs" data-v-b8818f8c>后端 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/manager/basic" data-v-b8818f8c>管理 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/me/about" data-v-b8818f8c>关于我 <!----></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/answer185/blog" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/basic/data-structure" data-v-b8818f8c>编程基础 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/frontend/basic" data-v-b8818f8c>前端 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/backend/nodejs" data-v-b8818f8c>后端 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/manager/basic" data-v-b8818f8c>管理 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/me/about" data-v-b8818f8c>关于我 <!----></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/answer185/blog" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><p class="sidebar-link-item">前端</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend/basic">前端基础</a><!----></li><li class="sidebar-link"><p class="sidebar-link-item">前端架构</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend/framework">架构概述</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend/build">前端工程</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend/monorepo">Monorepo</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend/react">React生态</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend/vue">Vue生态</a><!----></li><li class="sidebar-link"><p class="sidebar-link-item">前端开发</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend/pwa">PWA总结</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend/componnet-library">组件库总结</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/frontend/micro-frontend">微前端总结</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#架构理论">架构理论</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#背景">背景</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#实现思路">实现思路</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#拆分方式">拆分方式</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#架构设计点">架构设计点</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#不足">不足</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#行业方案">行业方案</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#iframe">iframe</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#qiankun">qiankun</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#后台微前端实践">后台微前端实践</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#总体设计">总体设计</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#开发">开发</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#疑难问题及解决">疑难问题及解决</a><!----></li></ul></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend/element-plus-build">Element-plus的构建原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend/component-import">组件库的加载</a><!----></li></ul></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="微前端" tabindex="-1">微前端 <a class="header-anchor" href="#微前端" aria-hidden="true">#</a></h1><p><div class="table-of-contents"><ul><li><a href="#架构理论">架构理论</a><ul><li><a href="#背景">背景</a></li><li><a href="#实现思路">实现思路</a></li><li><a href="#拆分方式">拆分方式</a></li><li><a href="#架构设计点">架构设计点</a></li><li><a href="#不足">不足</a></li></ul></li><li><a href="#行业方案">行业方案</a><ul><li><a href="#iframe">iframe</a></li><li><a href="#qiankun">qiankun</a></li></ul></li><li><a href="#后台微前端实践">后台微前端实践</a><ul><li><a href="#总体设计">总体设计</a></li><li><a href="#开发">开发</a></li><li><a href="#疑难问题及解决">疑难问题及解决</a></li></ul></li></ul></div></p><h2 id="架构理论" tabindex="-1">架构理论 <a class="header-anchor" href="#架构理论" aria-hidden="true">#</a></h2><h3 id="背景" tabindex="-1">背景 <a class="header-anchor" href="#背景" aria-hidden="true">#</a></h3><p>企业考虑使用微前端架构的原因主要有3个：</p><ol><li>遗留系统的隔离：相引入新的技术栈，但是又不想动老系统。</li><li>聚合前端开发：将分散的各个应用聚合，方便使用及管理。</li><li>巨石应用的拆分：单页应用不拆分，会越来越庞大，最后变成一个很难维护的应用。启动慢，热更新慢及打包慢。开发体验很差。</li></ol><p>微前端架构应运而生，需要达到：</p><ol><li>技术栈无关</li><li>应用自治：独立运行时及独立开发和部署</li><li>单一职责：每个应用会有自己负责区域</li></ol><h3 id="实现思路" tabindex="-1">实现思路 <a class="header-anchor" href="#实现思路" aria-hidden="true">#</a></h3><ul><li>路由分发式：通过反向代理，将请求路由到对应的应用上。</li><li>前端的微服务化：在不同的框架之上设计通信和加载机制。以使一个页面内加载对应的应用。</li><li>微应用：通过软件工程的试，在部署构建环境中，把多个独立的应用组合成一个单体应用。</li><li>微件化：开发新的构建系统，把应用打包成独立的chunk代码，然后远程加载。</li><li>前端容器化：使用iframe来加载</li><li>应用组件化：使用Web Components技术来构建</li></ul><p>微应用、微件及应用组件库与现在的工程体系相差太多，基本上不会使用。主要是路由分发式和前端的微服务化。</p><h3 id="拆分方式" tabindex="-1">拆分方式 <a class="header-anchor" href="#拆分方式" aria-hidden="true">#</a></h3><p>没有标准的方式，只有一定的考虑角度。</p><ul><li>按照业务拆分</li><li>权限</li><li>更新频率</li><li>组织机构</li><li>和后端的微服务保持一致</li></ul><p>主要的目标是尽量减少耦合，更接近业务。</p><h3 id="架构设计点" tabindex="-1">架构设计点 <a class="header-anchor" href="#架构设计点" aria-hidden="true">#</a></h3><ul><li>架构模式：基座模式和自组织模式。后者基本不会去考虑。</li><li>组件与模式库： 抽离出公共的部分</li><li>应用注册：规划应用的名称、端口、地址等信息，并注册到基座应用中</li><li>专用构建系统：需要调整输出的格式</li><li>共享数据结构及操作：比如：主框架应该共享哪些数据，以何种情况存储，数据结构应该是什么样</li><li>应用通信机制：主流框架主要考虑的是应用之间，但是实际后台系统需要的是页面层级的通信</li></ul><h3 id="不足" tabindex="-1">不足 <a class="header-anchor" href="#不足" aria-hidden="true">#</a></h3><ul><li>项目切换</li></ul><h2 id="行业方案" tabindex="-1">行业方案 <a class="header-anchor" href="#行业方案" aria-hidden="true">#</a></h2><h3 id="iframe" tabindex="-1">iframe <a class="header-anchor" href="#iframe" aria-hidden="true">#</a></h3><h4 id="实现原理" tabindex="-1">实现原理 <a class="header-anchor" href="#实现原理" aria-hidden="true">#</a></h4><ol><li>在主应用中管理所有的iframe窗口。每个链接对应一个内部标签页，不重复打开。</li><li>每个标签对应一个iframe， 并生成一个唯一的id。</li><li>通过postMessage及监听message事件，实现主应用对子应用、子应用对主应用及子应用对子应用的通信。</li></ol><h4 id="相关api" tabindex="-1">相关API <a class="header-anchor" href="#相关api" aria-hidden="true">#</a></h4><ol><li>window.parent: 返回当前窗口的父窗口对象。如果一个窗口没有父窗口,则它的 parent 属性为自身的引用.</li><li>window.postMessage: 分发一个 MessageEvent 消息。第一个参数为消息数据，第二个参数指定哪些窗口可以接收，*表示不限。可以安全地实现跨源通信。</li><li>window.addEventListner(&#39;messsage&#39;, handleMessage, false): 监听广播的message，并做处理</li></ol><h4 id="问题及解决" tabindex="-1">问题及解决 <a class="header-anchor" href="#问题及解决" aria-hidden="true">#</a></h4><ol><li>跨域问题：不要通过frameId直接获取相应window的对象，并访问相应的内部变量，如下代码会出现跨域：</li></ol><div class="language-js"><pre><code>window<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>frames<span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">iframe_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>parentId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>actionName<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
</code></pre></div><p>解决： 通过postMessage来发送消息，并监听消息来处理：</p><div class="language-js"><pre><code>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">iframe_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>parentId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token operator">...</span>params
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>message事件监听的时机： 对vue来说，在created和onMounted都可以，建议在onMounted。</li><li>message的解析规则：可以确定了一些固定的参数，如API名称，来确定应该如何处理消息。</li><li>打开及关闭标签页面的逻辑处理：修改router.push及router.back, 判断运行环境，并做拦截处理</li><li>页面之间的数据通信。</li></ol><p>这里假设场景： A页面是一个表单，某个表单项的修改，需要新开一个页面B，保存成功后，需要把数据同步到A页面，数据随A页面一起提交。 以下是一个参考的实现方式：</p><ul><li>在A页面点开B页面时，需要把iframe标识带过去</li><li>在B页面保存时，先把表单的数据保存在本地，如localStorage中。</li><li>发布一个postMessage，更新相应的信息处理标记</li><li>间隔500毫秒左右再执行关闭标签页面的操作，否则localstorage里的数据可能没有成功</li><li>在A页面中监听信息标记的变化，如果为true时，从按约定从本地获取数据（在多标签页面的后台系统中，已打开的标签页面，不会因为切换了页面而卸载）</li><li>处理好数据后，清空本地数据并更新标记。</li></ul><p>整个代码结构如下:</p><div class="language-js"><pre><code><span class="token comment">// A表单页面打开B页面</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/path/to/B&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">,</span> <span class="token literal-property property">frameId</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>frameId<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// B页面保存时的，通知主应用</span>
localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&#39;localtDataName&#39;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>rawData<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  window<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">api</span><span class="token operator">:</span> <span class="token string">&#39;handleFunc&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">arguments</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">frameId</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token literal-property property">action</span><span class="token operator">:</span> <span class="token string">&#39;...&#39;</span><span class="token punctuation">,</span>
      <span class="token operator">...</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>

<span class="token comment">// 主应用，根据frameId，发送更新消息，并转发相关参数</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">iframe</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>frameId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">api</span><span class="token operator">:</span> <span class="token string">&#39;messageHandleFunc&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">arguments</span><span class="token operator">:</span> args
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&#39;*&#39;</span><span class="token punctuation">)</span>

<span class="token comment">// A页面的监听事件接收</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;message&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> params <span class="token operator">=</span> e<span class="token punctuation">.</span>data
    <span class="token comment">// 当前页面的事件监听条件</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span>condition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 更新标记</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">&#39;actionName&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token boolean">false</span>
<span class="token punctuation">)</span>

<span class="token comment">// store中更新相应的标记</span>
state<span class="token punctuation">.</span>status <span class="token operator">=</span> payload<span class="token punctuation">.</span>status

<span class="token comment">// A页面相关组件绑定及watch</span>
<span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token function">tagStatus</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 处理业务逻辑</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token comment">// 修改标记状态为false</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>以上的流程中，数据可以不在本地保存，直接通过postMessage带</p><p>上面的交互是一个复杂的场景，只是作为例子，实际开发中建议通过修改交互，如弹窗来处理。</p><ol start="6"><li><p>后台标签页面的管理</p></li><li><p>页面权限的处理</p></li></ol><h4 id="iframe的不足" tabindex="-1">iframe的不足 <a class="header-anchor" href="#iframe的不足" aria-hidden="true">#</a></h4><p>为什么不用 iframe，这几乎是所有微前端方案第一个会被挑战的问题。但是大部分微前端方案又不约而同放弃了 iframe 方案，自然是有原因的，并不是为了 &quot;炫技&quot; 或者刻意追求 &quot;特立独行&quot;。</p><p>如果不考虑体验问题，iframe 几乎是最完美的微前端解决方案了。</p><p>iframe 最大的特性就是提供了浏览器原生的硬隔离方案，不论是样式隔离、js 隔离这类问题统统都能被完美解决。但他的最大问题也在于他的隔离性无法被突破，导致应用间上下文无法被共享，随之带来的开发体验、产品体验的问题。</p><ol><li>url 不同步。浏览器刷新 iframe url 状态丢失、后退前进按钮无法使用。</li><li>UI 不同步，DOM 结构不共享。想象一下屏幕右下角 1/4 的 iframe 里来一个带遮罩层的弹框，同时我们要求这个弹框要浏览器居中显示，还要浏览器 resize 时自动居中..</li><li>全局上下文完全隔离，内存变量不共享。iframe 内外系统的通信、数据同步等需求，主应用的 cookie 要透传到根域名都不同的子应用中实现免登效果。（实际上就是产生了很多页面）</li><li>慢。每次子应用进入都是一次浏览器上下文重建、资源重新加载的过程。</li><li>网页截屏，iframe 就不被支持</li><li>其他： 不容易打印、无法被一些搜索引擎解析、增加http请求及不符合标准网页设计的理念，已经被标准网页设计抛弃。</li></ol><p>其中有的问题比较好解决(问题1)，有的问题我们可以睁一只眼闭一只眼(问题4)，但有的问题我们则很难解决(问题3)甚至无法解决(问题2)，而这些无法解决的问题恰恰又会给产品带来非常严重的体验问题， 最终导致我们舍弃了 iframe 方案。</p><h3 id="qiankun" tabindex="-1">qiankun <a class="header-anchor" href="#qiankun" aria-hidden="true">#</a></h3><h2 id="后台微前端实践" tabindex="-1">后台微前端实践 <a class="header-anchor" href="#后台微前端实践" aria-hidden="true">#</a></h2><h3 id="总体设计" tabindex="-1">总体设计 <a class="header-anchor" href="#总体设计" aria-hidden="true">#</a></h3><h3 id="开发" tabindex="-1">开发 <a class="header-anchor" href="#开发" aria-hidden="true">#</a></h3><h3 id="疑难问题及解决" tabindex="-1">疑难问题及解决 <a class="header-anchor" href="#疑难问题及解决" aria-hidden="true">#</a></h3></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-07c132fc><div class="edit" data-v-07c132fc><div class="edit-link" data-v-07c132fc data-v-1ed99556><!----></div></div><div class="updated" data-v-07c132fc><!----></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/frontend/componnet-library" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>组件库总结</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/frontend/element-plus-build" data-v-38ede35f><span class="text" data-v-38ede35f>Element-plus的构建原理</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"backend_go.md\":\"2c6452d4\",\"backend_java.md\":\"55c6b0db\",\"backend_nodejs.md\":\"ec2b1754\",\"backend_php.md\":\"f035a2b4\",\"backend_sql.md\":\"41fd906d\",\"basic_algorithm.md\":\"a9d2de9b\",\"basic_data-structure.md\":\"92574ec2\",\"basic_http.md\":\"c4de718b\",\"frontend_basic.md\":\"097b9bfa\",\"frontend_build.md\":\"50de8430\",\"frontend_component-import.md\":\"031b5864\",\"frontend_componnet-library.md\":\"e8003cee\",\"frontend_element-plus-build.md\":\"d0350dce\",\"frontend_framework.md\":\"f78d905b\",\"frontend_micro-frontend.md\":\"3097cd22\",\"frontend_monorepo.md\":\"b4ceba63\",\"frontend_pwa.md\":\"e376dcac\",\"frontend_react.md\":\"ede7a121\",\"frontend_vue.md\":\"26c31322\",\"index.md\":\"25bc726c\",\"manager_basic.md\":\"02618660\",\"manager_project.md\":\"8480e157\",\"manager_team.md\":\"8d0ab147\",\"me_about.md\":\"58560401\",\"me_resume.md\":\"886e8800\"}")</script>
    <script type="module" async src="/assets/app.05e3c997.js"></script>
    
  </body>
</html>